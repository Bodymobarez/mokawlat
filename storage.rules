rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // By default, allow reads for all files.
    // Most files like logos, employee photos, daily log photos should be readable by anyone with the link.
    match /{allPaths=**} {
      allow read;
    }

    // Company logo can be uploaded by admins.
    // Firestore rules will gate the UI, this is an additional layer.
    match /company/{allPaths=**} {
      allow write: if request.auth != null;
    }

    // Project files can be uploaded by authenticated users.
    // Access to create the corresponding Firestore document is the real gatekeeper.
    match /projects/{projectId}/{allPaths=**} {
      allow write: if request.auth != null;
    }
    
    // Employee profile photos can be uploaded by authenticated users.
    match /employees/{employeeId}/{allPaths=**} {
      allow write: if request.auth != null;
    }

    // Contract files can be uploaded by authenticated users.
    match /contracts/{allPaths=**} {
      allow write: if request.auth != null;
    }
  }
}
